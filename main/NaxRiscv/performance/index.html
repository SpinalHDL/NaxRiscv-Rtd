

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Performance and Area &mdash; NaxRiscv  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/logo3_32x32.png"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/wavedrom/2.6.8/skins/default.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/wavedrom/2.6.8/wavedrom.min.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Abstractions / HDL" href="../abstraction/index.html" />
    <link rel="prev" title="Simulation" href="../simulation/index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> NaxRiscv
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction/index.html#naxriscv">NaxRiscv</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction/index.html#project-developpement-and-status">Project developpement and status</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction/index.html#why-a-ooo-core-targeting-fpga">Why a OoO core targeting FPGA</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/index.html#pipeline">Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/index.html#how-to-use">How to use</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction/index.html#hardware-description">Hardware description</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../frontend/index.html">Frontend</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../frontend/index.html#decoder">Decoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../frontend/index.html#physical-register-allocation">Physical register allocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../frontend/index.html#architectural-to-physical">Architectural to physical</a></li>
<li class="toctree-l2"><a class="reference internal" href="../frontend/index.html#physical-to-rob-id">Physical to ROB ID</a></li>
<li class="toctree-l2"><a class="reference internal" href="../frontend/index.html#dispatch-issue">Dispatch / Issue</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../execution_units/index.html">Execution units</a></li>
<li class="toctree-l1"><a class="reference internal" href="../memory/index.html">Memory system</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../memory/index.html#load-store-unite">Load store unite</a></li>
<li class="toctree-l2"><a class="reference internal" href="../memory/index.html#mmu">MMU</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../branch_prediction/index.html">Branch prediction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../branch_prediction/index.html#fetch-prediction">Fetch prediction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../branch_prediction/index.html#decode-prediction">Decode prediction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../branch_prediction/index.html#jump-branch-circular-buffer">Jump/branch circular buffer</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../backend/index.html">Backend</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../backend/index.html#commit">Commit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backend/index.html#register-file">Register file</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../simulation/index.html">Simulation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../simulation/index.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../simulation/index.html#spike">Spike</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Performance and Area</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#rv32">RV32</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rv64">RV64</a></li>
<li class="toctree-l2"><a class="reference internal" href="#notes">Notes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../abstraction/index.html">Abstractions / HDL</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../abstraction/index.html#framework">Framework</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../abstraction/index.html#plugin-tasks">Plugin tasks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../abstraction/index.html#service-definition">Service definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../abstraction/index.html#service-implementation">Service implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../abstraction/index.html#service-usage">Service usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../abstraction/index.html#service-pipeline-definition">Service Pipeline definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../abstraction/index.html#service-pipeline-usage">Service Pipeline usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../abstraction/index.html#execution-units">Execution units</a></li>
<li class="toctree-l3"><a class="reference internal" href="../abstraction/index.html#shiftplugin">ShiftPlugin</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../abstraction/index.html#pipeline">Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../abstraction/index.html#state-machine-api">State machine API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../abstraction/index.html#automated-multiport-memory-transformation">Automated multiport memory transformation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../misc/index.html">Misc</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../misc/index.html#jtag-openocd-gdb">Jtag / OpenOCD / GDB</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">NaxRiscv</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Performance and Area</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/NaxRiscv/performance/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="performance-and-area">
<h1>Performance and Area<a class="headerlink" href="#performance-and-area" title="Permalink to this headline">¶</a></h1>
<div class="section" id="rv32">
<h2>RV32<a class="headerlink" href="#rv32" title="Permalink to this headline">¶</a></h2>
<p>A few things to keep in mind :</p>
<ul class="simple">
<li><p>You can trade FMax IPC Area</p></li>
<li><p>There is better IPC xor FMAX xor Area configs</p></li>
</ul>
<p>For the following configuration :</p>
<ul class="simple">
<li><p>RV32IMASU, dual issue,OoO, linux compatible</p></li>
<li><p>64 bits fetch, 2 decode, 3 issue, 2 retire</p></li>
<li><p>Shared issue queue with 32 entries</p></li>
<li><p>Renaming with 64 physical registers</p></li>
<li><p>3 execution unit (2*Int/Shift, 1*Branch/load/store/mul/div/csr/env)</p></li>
<li><p>LSU with 16 load queue, 16 store queue</p></li>
<li><p>Load hit predictor (3 cycles load to use delay)</p></li>
<li><p>Store to load bypass / hazard free predictor</p></li>
<li><p>I$ 16KB/4W, D$ 16KB/4W 2 refill 2 writeback slots</p></li>
<li><p>MMU with ITLB 6 way/192 entries, DTLB 6 way/192 entries</p></li>
<li><p>BTB 1 way/512 entries, GSHARE 1 way/4KB, RAS 32 entries</p></li>
</ul>
<p>Performance :</p>
<ul class="simple">
<li><p>Dhrystone   : 2.59 DMIPS/Mhz    1.42 IPC (-O3 -fno-common -fno-inline)</p></li>
<li><p>Coremark    : 4.70 Coremark/Mhz 1.19 IPC (-O3 and so many more random flags)</p></li>
<li><p>Embench-iot : 1.55 baseline     1.32 IPC (-O2 -ffunction-sections)</p></li>
</ul>
<p>On Artix 7 speed grade 3 :</p>
<ul class="simple">
<li><p>14.6 KLUT, 9.8 KFF, 12.5 BRAM, 4 DSP</p></li>
<li><p>145 Mhz</p></li>
</ul>
<p>Reducing the number of int ALU to a single one will produce :</p>
<p>Performance :</p>
<ul class="simple">
<li><p>Dhrystone   : 2.54 DMIPS/Mhz    (-O3 -fno-common -fno-inline)</p></li>
<li><p>Coremark    : 4.19 Coremark/Mhz (-O3 and so many more random flags)</p></li>
<li><p>Embench-iot : 1.33 baseline     (-O2 -ffunction-sections)</p></li>
</ul>
<p>On Artix 7 speed grade 3 :</p>
<ul class="simple">
<li><p>13.2 KLUT, 9.7 KFF, 12.5 BRAM, 4 DSP</p></li>
<li><p>148 Mhz</p></li>
</ul>
<p>To go further, increasing the GSHARE storage or implementing something as TAGE should help.</p>
<p>Here are a pipeline representation of the two above configurations :</p>
<img alt="../../_images/pipeline_simple.png" src="../../_images/pipeline_simple.png" />
<p>Also notes that the NaxRiscv simulator support gem5 / konata logs, allowing to visualise the execution flow.</p>
</div>
<div class="section" id="rv64">
<h2>RV64<a class="headerlink" href="#rv64" title="Permalink to this headline">¶</a></h2>
<p>In a similar configuration than the above RV32 (2*Int/Shift, 1*Branch/load/store/mul/div/csr/env)</p>
<p>Performance :</p>
<ul class="simple">
<li><p>Dhrystone   : 2.54 DMIPS/Mhz    (-O3 -fno-common -fno-inline)</p></li>
<li><p>Coremark    : 4.75 Coremark/Mhz (-O3, u32 as s32 and so many more random flags)</p></li>
<li><p>Embench-iot : 1.70 baseline     (-O2 -ffunction-sections)</p></li>
</ul>
<p>On Artix 7 speed grade 3 :</p>
<ul class="simple">
<li><p>19.5 KLUT, 12.0 KFF, 12.5 BRAM, 16 DSP</p></li>
<li><p>140 Mhz</p></li>
</ul>
<p>So overall, the RV64 support do not has too much of an impact compared to RV32, mostly because the current critical path are in the addresses and control paths, which stays relatively similar between the two (39 bits for RV64, 32 bits for RV32).</p>
</div>
<div class="section" id="notes">
<h2>Notes<a class="headerlink" href="#notes" title="Permalink to this headline">¶</a></h2>
<p>Here is a few notes collected durring the developpement :</p>
<ul class="simple">
<li><p>An out of order CPU without branch prediction is performing realy bad ^^</p></li>
<li><p>Avoiding store having to wait for the store data in the IQ can realy help avoiding bad load speculation.</p></li>
<li><p>Some tests were made with two cycle latency ALU (in prevision of RV64 timing relaxation) seems to show “little” impact on the overall performances (~15%, need to verify on more benchmarks)</p></li>
<li><p>Adding more and more execution units seems to goerealy fast into diminushing returns lands</p></li>
</ul>
</div>
</div>

    <script type="text/javascript">
        function init() {
            WaveDrom.ProcessAll();
        }
        window.onload = init;
    </script>

           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../abstraction/index.html" class="btn btn-neutral float-right" title="Abstractions / HDL" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../simulation/index.html" class="btn btn-neutral float-left" title="Simulation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, Spaghetti god.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>